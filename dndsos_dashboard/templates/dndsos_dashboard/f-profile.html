{% extends 'dndsos_dashboard/base.html' %}
{% load static %}
{% load i18n %}

{% block content %}
{% get_current_language as lang %}

<link rel="stylesheet" href="{% static 'assets/vendor/dropzone/css/basic.css' %}" />
<link rel="stylesheet" href="{% static 'assets/vendor/dropzone/css/dropzone.css' %}" />
<style>
	div.payments  img{
		max-width: 100%;
		max-height: 100%;
	}
</style>

    <section role="main" class="content-body" {% if lang == 'he' %} dir='rtl' align='right' {% else %} style="text-align: left;"{% endif %}>
					<header class="page-header">
						<h2>{% trans 'Carrier Profile' %}</h2>
					
						<div class="right-wrapper pull-right">
							<ol class="breadcrumbs">
								<li>
									<a href="{% url 'dndsos_dashboard:f-dashboard' f_id=user.pk %}">
										<i class="fa fa-home"></i>
									</a>
								</li>
								<li><span> {% trans 'Profile' %}</span></li>
							</ol>
					
							<a class="sidebar-right-toggle" data-open="sidebar-right"><i class=""></i></a>
						</div>
					</header>

					<!-- start: page -->

					<div class="row">
						<div class="col-md-3 col-lg-2">
						</div>
						<div class="col-md-9 col-lg-7">

							<div class="tabs">
								<ul class="nav nav-tabs tabs-primary">
									<li class="active">
										<a href="#overview" data-toggle="tab">{% trans 'Overview' %}</a>
									</li>
									<li>
										<a href="#edit" data-toggle="tab">{% trans 'Edit Profile' %}</a>
									</li>
									<li>
										<a href="#payments" data-toggle="tab">{% trans 'Get Paid' %}</a>
									</li>

								</ul>
								<div class="tab-content">
									<div id="overview" class="tab-pane active">
										<h4>{% trans 'Profile Information' %} -
											{% if profile.is_approved %} 
											<span style="color: green; border: solid green 2px; padding:0.5rem; border-radius: 2rem  " ><b>{% trans 'Approved' %}</b></span> 
											{% else %}
											<span style="color: red;" ><b>{% trans 'Not Approved' %}</b> 
												<span style="font-size: 1.5rem;">({% trans 'Please complete profile' %})</span> 
											</span>
											{% endif %}

										</h4>
										<section class="panel panel-group">
											<header class="panel-heading bg-primary"> 
												<div class="widget-profile-info">
													<div class="profile-picture">
														<img src="{{ profile.profile_pic.url }}" alt="">
													</div>
													<div class="profile-info">
														<h4 class="name text-semibold">{{ profile.name }}</h4>
														<div class="profile-footer">
															<p class="text-left">{% trans 'Carrier Vehicle' %}: {{ profile.vehicle }}</p>
														</div>
													</div>
												</div>
											</header>
											<div class="panel-body">
												<p><b>{% trans 'Email' %}</b>: {{ email }}</p>
												<p><b>{% trans 'Phone' %}</b>: {{ profile.phone }}</p>
												<p><b>{% trans 'Vehicle' %}</b>: {{ profile.vehicle }}</p>
												<p><b>{% trans 'Bio' %}: </b> {{ profile.bio }}</p>
												<p><b>{% trans 'Rating' %}: </b> {{ profile.rating }}</p>
											</div>
										</section>
										<div class="widget-toggle-expand mb-md">
											<div class="widget-header">
												<h6>{% trans 'Profile Completion' %} ({{ complete }}%)</h6>
												<!-- <div class="widget-toggle">+</div> -->
											</div>
											<div class="widget-content-collapsed">
												<div class="progress progress-xs light">
													<div class="{% if complete < 100 %} progress-bar-danger {% else %} progress-bar-success {% endif %}" role="progressbar" aria-valuenow="{{ complete }}" aria-valuemin="0" aria-valuemax="100" style="width: {{ complete }}%; ">
														{{ complete }}
													</div>
												</div>
											</div>
											<div class="widget-content-expanded">
												<ul class="simple-todo-list">
													<li class="{% if required_fields.name %}completed{% else %}{% endif %}">{% trans 'Name' %} </li>
													<li class="{% if required_fields.vehicle %}completed{% else %}{% endif %}">{% trans 'Vehicle' %} </li>
													<li class="{% if required_fields.phone %}completed{% else %}{% endif %}">{% trans 'Phone' %} </li>
													<li class="{% if required_fields.id_doc %}completed{% else %}{% endif %}">{% trans 'ID Document' %} </li>
												</ul>
											</div>
										</div>


									</div>
									<div id="edit" class="tab-pane">

										<form class="form-horizontal" enctype="multipart/form-data" name="businessProfile" method="POST">
											{% csrf_token %}
											<h4 class="mb-xlg">{% trans 'Personal Information' %}</h4>
												<fieldset>
													{% for non_field_error in form.non_field.errors %}
														<p class="help is-danger">{{ non_field_error }}</p>
													{% endfor %}
														<div class="form-group">
															<div class="row">
																<label class="col-md-3 control-label" for="">{% trans 'Name' %}</label>
																<div class="col-md-4">{{ form.name }}</div>	
															</div>

															<div class="row" style="margin-top: 1%;">
																<label class="col-md-3 control-label" for="">{% trans 'Phone Number' %}</label>
																{% if user.freelancer.phone %}
																<div class="col-md-4 text-center" style="margin-top: 1%;">
																	{{ user.freelancer.phone  }}
																</div>
																{% else %}
																<div class="col-md-4">
																	<input class="form-control" type="text" name="phoneNumber" placeholder="{% trans 'Phone' %} ({% trans 'with country prefix' %})">
																</div>
																<button class="btn btn-primary" name="addPhone" type="submit">{% trans 'Add Phone' %}</button>
																{% endif %}
															</div>

															<div class="row" style="margin-top: 1%;">
																<label class="col-md-3 control-label" for="">{% trans 'eMail' %}</label>
																<div class="col-md-4 text-center" style="padding-top: 0.5rem;">{{ user }}</div>	
															</div>
															<div class="row" style="margin-top: 1%;">
																<label class="col-md-3 control-label" for="">{% trans 'Vehicle' %}</label>
																<div class="col-md-4">{{ form.vehicle }}</div>	
															</div>
															<div class="row" style="margin-top: 1%;">
																<label class="col-md-3 control-label" for="">{% trans 'Short Bio' %}</label>
																<div class="col-md-4">{{ form.bio }}</div>	
															</div>
															<div class="row" style="margin-top: 1%;">
																<label class="col-md-3 control-label" for="">{% trans 'Country' %}</label>
																<div class="col-md-4">{{ form.country }}</div>	
															</div>
															<div class="row text-left" style="margin: 2%;" >
																<label class="col-md-3 control-label" for="">{% trans 'ID Document' %}</label>
																<div class="col-md-6 text-left" dir="ltr">{{ form.id_doc }}</div>

															</div>
															<div class="row" style="margin-top: 1%;">
																<label class="col-md-3 control-label" for="">{% trans 'Active Hours' %}</label>
																<div class="col-md-4">{{ form.active_hours }}</div>	
															</div>
															<div class="row" style="margin-top: 1%;">
																<label class="col-md-3 control-label" for="">{% trans 'Newsletter Optin' %}</label>
																<div class="col-md-1 text-left" style="padding-top: 1rem;">{{ form.newsletter_optin }}</div>
															</div>


														</div>
													<div class="row">
														<div class="col-3"></div>
														<div class="col-md-3 col-md-offset-3">
															<img src="{% if user.freelancer.profile_pic %}{{user.freelancer.profile_pic.url}} {% else %} {% static 'assets/images/no-img.jpg' %} {% endif %}" style='max-width:50%' id="preview" name="old_profile_pic" alt="Avatar">
															<span class="">
																<input type="file" id="profile_pic"  onchange="preview_image()" name="profile_pic">
															</span>
														</div>
													</div>
												</fieldset>
												<hr class="dotted tall">
												<a class="btn btn-warning" href="{% url 'password_change' %}" role="button">{% trans 'Change Password' %}</a>

												<div class="panel-footer">
												<div class="row">
													<div class="col-md-9 col-md-offset-3">
														<button name="updateProfile" type="submit" class="btn btn-primary">{% trans 'Submit' %}</button>
														<button type="reset" class="btn btn-default">{% trans 'Reset' %}</button>
													</div>
												</div>
											</div>

										</form>

									</div>

									<div id="payments" class="tab-pane">
										<section>	
											<div class="panel panel-featured panel-featured-primary">
												<header>
													<div class="panel-header">
														<h1 class="panel-title" style="margin-top: 2rem;">
															{% trans 'Balance' %}
														</h1>
													</div>
													<div class="panel-body">
														<h4>{% trans 'Your Balance' %}: <b>${{ earnings_due }}</b></h4>
													</div>
												</header>
											</div>
										</section>

										<section>	
											<form action="" method="POST" enctype="multipart/form-data" name="paymentMethodsForm" id="paymentMethodsForm">
												{% csrf_token %}
												<div class="panel panel-featured panel-featured-primary">
													<header>
														<div class="panel-header">
															<h1 class="panel-title" style="margin-top: 2rem;">
																{% trans 'Payment Methods' %}
															</h1>
														</div>
													</header>
													<div class="panel-body">

														<!-- Paypal -->
														<div class="row form-group">
															<div class="col-md-2 payments">
																<img src="{% static 'assets/images/paypal-logo.png' %}" alt="paypal-logo">
															</div>
															<div class="col-md-6">
																<input name="paypal_account" class="form-control" type="text" placeholder="{% if user.freelancer.paypal_account %} {{ user.freelancer.paypal_account }} {% else %}Enter Paypal account here {% endif %}">
															</div>
															<div class="col-md-2">
																<button type="submit" name="addPaypal" id="addPaypal" class="btn btn-primary ">{% trans 'Update' %}</button>
															</div>
															<div class="col-md-1">
																<button type="submit" name="makePreferred_paypal" class="btn {% if user.freelancer.preferred_payment_method == 'PayPal' %} btn-primary {% else %} btn-secondary {% endif %}" >{% trans 'Preferred' %}</button>
															</div>
														</div>

														<style>
															.my-checkbox {
																font-size: 3rem;
															}
														</style>

														<!-- Bank Transfer -->
														<div class="row form-group">
															<div class="col-md-2 payments">
																<img src="{% static 'assets/images/bank-transfer.png' %}" alt="bit-logo" style="max-width: 50%;">
															</div>
															<div class="col-md-6">
																<h5>{% if user.freelancer.bank_details %} IBAN: {{ user.freelancer.bank_details.iban }} {% else %} {% trans 'Update your bank details' %}. {% endif %}</h5>
															</div>
															<div class="col-md-2">
																<a href="{% url 'dndsos_dashboard:f-bank-details' f_id=user.pk %}" type="button" name="bankPayments" id="bankPayments" class="btn btn-primary ">{% trans 'Update' %}</a>
															</div>
															<div class="col-md-1">
																<button type="submit" name="makePreferred_bank" class="btn {% if user.freelancer.preferred_payment_method == 'Bank' %} btn-primary {% else %} btn-secondary {% endif %}" >{% trans 'Preferred' %}</button>
															</div>
														</div>
														
														<!-- Bit transer -->
														<div class="row form-group">
															<div class="col-md-2 payments">
																<img src="{% static 'assets/images/bit-logo.png' %}" alt="bit-logo" style="max-width: 50%;">
															</div>
															<div class="col-md-8">
																<p> {% trans 'Use my phone number for payments' %}.</p>
															</div>
															<div class="col-md-1">
																<button type="submit" name="makePreferred_phone" class="btn {% if user.freelancer.preferred_payment_method == 'Phone' %} btn-primary {% else %} btn-secondary {% endif %}" >{% trans 'Preferred' %}</button>
															</div>
														</div>


													</div>
												</div>
											</form>
										</section>
									</div>
							</div>
						</div>
					</div>
					<!-- end: page -->
    </section>
	<script src="{% static 'assets/vendor/fuelux/js/spinner.js' %}"></script>
	<script src="{% static 'assets/vendor/dropzone/dropzone.js' %}"></script>
	<script>
	function preview_image()
	{
	if(event.target.files.length > 0){
	   	$("#preview").attr('src', URL.createObjectURL(event.target.files[0]));
	   }
	}
	</script>
	<script type="application/javascript">
     
      
		$('#message').ready(function() {
			$('#exampleModal').modal({show:true});
			//$('#message').modal('hide');
		});
	</script>

	<script>
		$('sendPhoneVerify').on('submit', function(e){
			e.preventDefault();
			$("#phoneVerifyModal").modal("show");
		})
	</script>

{% endblock content %}
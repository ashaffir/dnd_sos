{% extends 'dndsos_dashboard/base.html' %}
{% load static %}
{% load i18n %}

{% block content %}
{% get_current_language as lang %}
{% include 'dndsos_dashboard/partials/_message-sent-modal.html' %}

<section role="main" class="content-body" {% if lang == 'he' %} dir='rtl' align='right' {% else %} style="text-align: left;"{% endif %}>
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.css" />
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.21/css/dataTables.bootstrap4.min.css" /> -->
    
    <header class="page-header">
        <h2>{% trans 'Deliveries' %}</h2>
    
        <div class="right-wrapper pull-right">
            <ol class="breadcrumbs">
                <li>
                    <a href="{% url 'dndsos_dashboard:f-dashboard' f_id=user.pk %}">
                        <i class="fa fa-home"></i>
                    </a>
                </li>
                <li><span>{% trans 'Deliveries' %}</span></li>
            </ol>
    
            <a class="sidebar-right-toggle" data-open="sidebar-right"><i class=""></i></a>
        </div>

    </header>

    <!-- start: page -->
        <section class="panel">
            <div class="panel-body">
                <h3 class="">{% trans 'Deliveries Summary Table' %}</h3>
                
                <div class="table-responsive">
                    <table class="table table-bordered table-striped mb-none display" id="deliveriesTable">
                        <!-- Dynamically updated deliveries table -->
                    </table>
                </div>

                <div class="row mobileShow center">
                    <i class='fa fa-arrows-h fa-3x'></i>
                </div>
            
            </div>
        </section>
    <!-- end: page -->
</section>

<script>
    
    $.ajax({
        url: "{% url 'orders:deliveries-table' %}",
        success: function(response) {
            $('#deliveriesTable').html(response);
        }
    })		
</script>

<!-- <script>

    /////// Price currency converter for table ///////

    let usd_ils_rate = '{{ usd_ils }}'
    let usd_eur_rate = '{{ usd_eur }}'

    window.addEventListener("load", function(){
        console.log('CONVERTING');
        let conv_price;
        let prices = document.querySelectorAll('[stam="order_fees"]');
        let leng = prices.length
        console.log(`LENG: ${leng}`);
        language = '{{ lang }}'
        if (language == 'he') {
            currency = '₪'
        } else if (language == 'en') {
            currency = '$'
        } else {
            currency = '€'
        }
        for (let price of prices) {
            console.log(`a`);

            price_ele = price.innerHTML;
            let t_price = price.innerText;
            let f_price = parseFloat(t_price);
            if (language == 'he') {
                conv_price = f_price * usd_ils_rate;
                price.innerHTML= conv_price.toFixed(1).toString() + ' ' + currency
            } else if (language == 'en') {
                conv_price = f_price;
                price.innerHTML= currency + ' ' + conv_price.toFixed(1).toString()
            } else {
                conv_price = f_price * usd_eur_rate;
                price.innerHTML= currency + ' ' + conv_price.toFixed(1).toString()
            }
        }

    });

</script> -->

{% endblock content %}

